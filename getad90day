Import-Module ActiveDirectory

$cutoff = (Get-Date).AddDays(-90)

Get-ADUser -Filter * -Properties LastLogonDate |
    Where-Object {
        $_.Enabled -eq $true -and (
            $_.LastLogonDate -eq $null -or
            $_.LastLogonDate -lt $cutoff
        )
    } |
    Select-Object Name,
                  SamAccountName,
                  Enabled,
                  LastLogonDate,
                  DistinguishedName |
    Sort-Object LastLogonDate |
    Export-Csv -Path "C:\Reports\StaleUsers_90Days.csv" -NoTypeInformation
